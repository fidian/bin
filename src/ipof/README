Source from
https://github.com/hilbix/misc/blob/master/src/ipof.c
as of December 30, 2011
